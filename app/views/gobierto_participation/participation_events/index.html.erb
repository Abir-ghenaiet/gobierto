<% content_for :breadcrumb_current_item do %>
  <h1>
    <%= link_to "Noticias", gobierto_participation_participation_events_path %>
  </h1>
<% end %>

<%= content_for :body_attributes do %>
  class="theme-participation gobierto_participation"
<% end %>

<div class="gradient-bg">
  <div class="column">

    <div class="pure-g">
      <div class="pure-u-1 pure-u-lg-1-3">
        <div class="content_side">

          <h2 class="with_separator">
            Agenda
            <% if params['from'] == 'participation_group' %>
              de Pacto social por el fin de la violencia de la género
              <%# link_to 'Pacto social por el fin de la violencia de la género', 'participation_group' %>
            <% end %>
          </h2>

          <% if params['from'] == 'participation_group' %>
          <div>
            <small><%= link_to 'ver todos los eventos', 'participation_agenda?from=participation' %></small>
          </div>
          <% end %>

          <% if params['from'] == 'participation' %>
          <div>
            <small><%= link_to 'ver todos los eventos', 'agenda' %></small>
          </div>
          <% end %>

          <!-- <p class="soft">Te invitamos a asistir a las siguientes reuniones donde debatiremos en persona sobre los temas de este proceso. Si no puedes asistir, iremos publicando online todo lo que se hable en la reuniones para facilitar el seguimiento y hacer accesibles las conclusiones.</p> -->

          <div class="calendar-component m_v_2">
            <%= month_calendar(
              partial: "gobierto_people/person_events/calendar_template",
              events: @events,
              attribute: :starts_at,
              start_date: params[:start_date] || Date.current
            ) do |date, events| %>
              <%= link_to_if events.any?, date.day, date: date, start_date: params[:start_date] %>
            <% end %>
          </div>

          <h4 class="with_light_separator m_t_1">Filtrar por tema</h4>

          <ul class="link_list">
            <% @issues.each do |issue| %>
              <li>
                <%= link_to issue.name , 'routing' %>
              </li>
            <% end %>
          </ul>

        </div>
      </div>

      <div id="participation-agenda" class="pure-u-1 pure-u-lg-2-3">

        <div class="events-filter">

          <% if @filtering_date %>
            <div class="box">
              <div class="inner">
                <%= t(".displaying_events_of", date: l(@filtering_date, format: :short)) %>
                <%= link_to t(".go_back"), [:gobierto_people, @person_event_scope, :events] %>
              </div>
            </div>
          <% end %>

        </div>

        <div class="events-summary">

          <div class="events-filter">

            <div class="pure-g block" >

              <div class="pure-u-1 pure-u-md-1-2">

                <h2 class="filter-option <%= class_if("active", !controller_name.include?("past_person_events")) %>">
                  <%= link_to_unless_current t(".upcoming_events"), [:gobierto_people, @person_event_scope, :events] %>
                </h2>

              </div>

              <div class="pure-u-1 pure-u-md-1-2 right">

                <h2 class="filter-option <%= class_if("active", controller_name.include?("past_person_events")) %>">
                  <%= link_to_unless_current t(".past_events"), [:gobierto_people, @person_event_scope, :past_events] %>
                </h2>

              </div>

            </div>

          </div>

          <p>
            <% if @past_events && @events.empty? %>
              <%= t(".no_past_events") %>
            <% else %>
              <% if @no_upcoming_events && @events.empty? %>
                <%= t(".no_events") %>
              <% elsif @no_upcoming_events %>
                <%= t(".no_upcoming_events") %>:
              <% end %>
            <% end %>
          </p>

          <div id="events">
            <% @events.each do |event| %>
              <%= render partial: "event_teaser", locals: { event: event } %>
            <% end %>
          </div>

          <%= link_to_next_page @events, t('.view_more'), class: "see_more", role: "button", remote: true %>
        </div>

      </div>

    </div>
  </div>
</div>

<script type="text/javascript">
$('.attend_event').click(function() {
  $(this).find('.fa').toggleClass('hidden');
  $(this).toggleClass('checked');

  // Swap text
  $(this).find('span').toggleText('Quiero asistir', 'Asistirás');
});
</script>
