<%
  set_meta_tags title: t('.title', place: @place.name, year: @year)
  set_meta_tags description: t('.description', place: @place.name, year: @year)
%>

<% content_for :breadcrumb_current_item do %>
  <h1>
    <%= link_to t('gobierto_budgets.layouts.menu_subsections.execution'), gobierto_budgets_budgets_execution_path(year: GobiertoBudgets::SearchEngineConfiguration::Year.last) %>
  </h1>
<% end %>

<div class="column">
  <div class="block">
    <div class="pure-g header_block_inline">
      <div class="pure-u-1 pure-u-md-1-2">
        <div class="inline_header">
          <h2 class="with_description p_h_r_1">Ejecución presupuestaria</h2>
          <%= render partial: 'gobierto_budgets/budgets/year_breadcrumb', locals: {path_calculation_method: :gobierto_budgets_budgets_path} %>

          <p>La ejecución es la cantidad que finalmente se ha gastado sobre lo presupuestado inicialmente. Es normal que haya desviaciones ya que es imposible preveer todos los gastos con precisión absoluta.</p>
          <p><strong>Última actualización:</strong> Junio 2017.</p>
        </div>
      </div>

      <div class="pure-u-1 pure-u-md-1-2 metric_boxes m_v_4">
        <div class="pure-g">
          <div class="pure-u-1-2 pure-u-md-1-2 metric_box">
            <div class="inner">
              <h3>Ejecución</h3>
              <div class="metric">54%</div>
              <div class="explanation">
                0,74% más que en 2015
              </div>
            </div>
          </div>

          <div class="pure-u-1-2 pure-u-md-1-2 metric_box">
            <div class="inner">
              <h3>Gasto presupuestado</h3>
              <div class="metric">4.483M</div>
              <div class="explanation">
                0,74% más que en 2015
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="pure-g">
      <div class="pure-u-1">
        <h2>Así va la ejecución de los gastos</h2>



      </div>
    </div>
  </div>

	<div class="execution">

		<div class="pure-g">
			<div class="pure-u-1 pure-u-lg-11-24 deviation_table_container">

        <h2 class="lite"><%= t('.budget_lines_income_higher') %></h2>

				<%= render partial: 'execution_table', locals: {data: @top_possitive_difference_income, kind: GobiertoBudgets::BudgetLine::INCOME, area: 'economic'} %>

				<div class="separator"></div>

        <h2 class="lite"><%= t('.budget_lines_income_lower') %></h2>

				<%= render partial: 'execution_table', locals: {data: @top_negative_difference_income, kind: GobiertoBudgets::BudgetLine::INCOME, area: 'economic'} %>

			</div>
			<div class="pure-u-1 pure-u-lg-2-24"></div>
			<div class="pure-u-1 pure-u-lg-11-24 deviation_table_container">

        <h2 class="lite"><%= t('.budget_lines_expense_higher') %></h2>

				<div class="form_filters">
	        <ul>
	          <li><%= link_to t('.economic'), '', class: 'toggle', "data-tab-target": 'economic' %></li>
	          <li class="active"><%= link_to t('.functional'), '', class: 'toggle', "data-tab-target": 'functional' %></li>
	        </ul>
	      </div>

				<div class="tab_content" data-tab="economic" style="display: none">

					<%= render partial: 'execution_table', locals: {data: @top_possitive_difference_expending_economic, kind: GobiertoBudgets::BudgetLine::EXPENSE, area: 'economic'} %>

					<div class="separator"></div>

          <h2 class="lite"><%= t('.budget_lines_expense_lower') %></h2>

					<%= render partial: 'execution_table', locals: {data: @top_negative_difference_expending_economic, kind: GobiertoBudgets::BudgetLine::EXPENSE, area: 'economic'} %>

				</div>

				<div class="tab_content" data-tab="functional">

					<%= render partial: 'execution_table', locals: {data: @top_possitive_difference_expending_functional, kind: GobiertoBudgets::BudgetLine::EXPENSE, area: 'functional'} %>

					<div class="separator"></div>

          <h2 class="lite"><%= t('.budget_lines_expense_lower') %></h2>

					<%= render partial: 'execution_table', locals: {data: @top_negative_difference_expending_functional, kind: GobiertoBudgets::BudgetLine::EXPENSE, area: 'functional'} %>
				</div>

			</div>
		</div>
	</div>
</div>

<%= render partial: 'widget_template_deviation' %>
